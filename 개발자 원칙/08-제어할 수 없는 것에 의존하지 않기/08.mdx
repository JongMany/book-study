Q: 일정을 지키고자 버그가 많은 SW를 출시하는 것이 마음에 들지 않음. 어떻게 하면 일정을 연기해서 안정된 SW를 내는 것이 더 중요하다고 리더를 설득할 수 있을까요?
A: 프로그래머에게 요구되는 것은 100점이 아닌 80-90점 짜리 프로그램을 기한 내에 완성하는 것이다.

퀄리티보다 일정이 더 중요한 것은 아님! 어느 한 쪽을 포기해야 한다는 개념이 아닌 "아무리 급해도 어떻게 80-90점 짜리 SW를 개발할 수 있는지"가 핵심임.

프로그래밍은 수 많은 선택의 연속임.
A코드와 B코드 중 어떤 것이 더 나을지에 대한 기준과 원칙이 있어야 함.
대부분의 경우, 쉽게 판단하고 그 시간을 아껴서 중요한 설계와 선택이 필요할 때 깊게 사고할 수 있는 시간을 확보할 수 있게 됨

본인만의 원칙을 세워 고민거리의 숫자가 빠르게 줄면 약속된 시간에 약속된 품질의 SW를 출시 할 수 있게 되는 것임.
-> 그렇다면 생각해봐야할 것 '나는 좋은 원칙을 알고 있는가?', '그 원칙들이 무의식적으로 발현되게 내재화 되어 있는가?'

흔히 개발자들 사이에 널리 알려진 원칙은 DRY, YAGNI, KISS임.

가장 중요한 원칙 "제어할 수 없는 것에 의존하지 않기"

> 현실 세계의 변화와 설계 사이의 결합도를 줄여야 한다. 전화번호를 식별자로 사용하는가? 자신의 힘으로 제어할 수 없는 속성에 의존하지 말라  
> -"실용주의 프로그래머"

예시) 자신이 제어할 수 없는 현실 세계 속성을 사용하는 경우

상황: 주민번호를 식별자로 사용하는 경우 (데이터베이스의 PK로 사용하는 경우)

주민 번호를 사용하려면 한 번의 변화와 크나큰 제약을 고려해야함

- 변화: 1975년 주민등록번호 체계가 변경됨
- 제약: 2014년 주민등록번호 무분별한 수집이 금지됨

2014년 법으로 주민등록번호 수집이 금지되면서 주민등록번호을 주요 키로 사용하던 시스템을 비즈니스 로직 구현을 뒤로 하고, 주민등록번호와의 의존성을 끊은 시스템 업데이트를 진행했어야 함.  
절대 변하지 않을 것이라 믿고 의존했던 속성이 제어할 수 없는 외부의 속성이었기에 이런 일이 발생함

### 코드 설계에 적용하기

테스트 코드 작성 역량과 무관하게 코드 자체가 테스트하기 적당하지 않은 코드인 경우, 테스트 코드를 작성하기 어려움

ex)

```js
// 주문일이 일요일이면 주문 금액의 10%를 할인하는 메서드
export default class Order {
  ...
  discount() {
    const now = LocalDateTime.now(); // 현재 시간을 반환하는 메서드
    if (now.getDayOfWeek() === DayOfWeek.SUNDAY) {
      this._amount = this._amount * 0.9;
    }
  }
}
```

위 코드는 결과를 예측하기 어려운 (테스트하기 어려운) 코드임.
이유는 LocalDateTime.now() 메서드가 반환하는 값이 현재 시간이기 때문에 테스트 코드를 작성하기 어려움

```js
it("일요일에 주문하면 10% 할인되어야 한다", () => {
  const sut = Order.of(10_000, OrderStatus.APPROVAL);
  sut.discount();
  expect(sut.amount).toBe(9_000);
});
```

이 테스트는 매주 일요일에 수행할 때만 통과할 수 있음.
테스트 대상인 discount가 언제나 같은 결과를 보장하지 않기 때문에 테스트 코드 작성이 어려움.
코드를 고치지 않고 테스트를 성고앟려면? `LocalDateTime.now()`를 모킹해야만 수행이 가능함.

제어하기 어려운 코드인 현재 시간 메서드를 외부에서 주입받도록 하면 됨

```ts
export default class Order {
  ...
  discount(now: LocalDateTime) {
    if (now.getDayOfWeek() === DayOfWeek.SUNDAY) {
      this._amount = this._amount * 0.9;
    }
  }
}
```

제어할 수 없었던 시간이라는 값을 내가 원하는 값으로 지정해서 테스트할 수 있게 도미

```ts
it("일요일에 주문하면 10% 할인되어야 한다", () => {
  const sut = Order.of(10_000, OrderStatus.APPROVAL);
  const now = LocalDateTime.of(2022, 8, 14, 10, 15, 0); // 2022-08-14 10:15:00로 고정
  sut.discount(now);
  expect(sut.amount).toBe(9_000);
});
```

1. 제어할 수 없는 값에 의존하는 코드를 최대한 멀리한다.
2. 주요 비즈니스 로직은 모두 제어할 수 있는 값만 의존하게 해 테스트 코드 작성이 쉬운 형태로 구성한다.

### 추천 책

- 실용주의 프로그래머
- 오늘, 또 일을 미루고 말았다.
